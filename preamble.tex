% ----------------------------------------------------------
% Packages
% ----------------------------------------------------------
\usepackage[
    ignoreheadfoot, 
    top=2 cm, 
    bottom=2 cm, 
    left=2 cm, 
    right=2 cm, 
    footskip=1.0 cm, 
]{geometry}
\usepackage{titlesec}
\usepackage{tabularx}
\usepackage{array}
\usepackage[dvipsnames]{xcolor}
\usepackage{enumitem}
\usepackage{fontawesome5}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{tikz}
\graphicspath{{images/}} % Tell LaTeX to look in the images folder
\usepackage[pscoord]{eso-pic}
\usepackage{calc}
\usepackage{lastpage}
\usepackage{changepage}
\usepackage{paracol}
\usepackage{ifthen}
\usepackage{needspace}
\usepackage{iftex}

% ----------------------------------------------------------
% Colors & Hyperlinks
% ----------------------------------------------------------
\definecolor{primaryColor}{RGB}{0, 0, 0}
\usepackage[
    pdftitle={John Doe CV},
    pdfauthor={John Doe},
    colorlinks=true,
    urlcolor=primaryColor
]{hyperref}
\usepackage{bookmark} % Moved here: must be loaded after hyperref

% ----------------------------------------------------------
% Font Setup
% ----------------------------------------------------------
\ifPDFTeX
  \input{glyphtounicode}
  \pdfgentounicode=1
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{lmodern}
\else
  \usepackage{fontspec}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
  \setmainfont{Georgia}[
    Path = fonts/, 
    Extension = .ttf, 
    UprightFont = georgia, 
    BoldFont = georgiab, 
    ItalicFont = georgiai, 
    BoldItalicFont = georgiaz  
    ]
\fi

% ----------------------------------------------------------
% Global Settings
% ----------------------------------------------------------
\raggedright
\AtBeginEnvironment{adjustwidth}{\partopsep0pt}
\pagestyle{empty}
\setcounter{secnumdepth}{0}
\setlength{\parindent}{0pt}
\setlength{\topskip}{0pt}
\setlength{\columnsep}{0.15cm}
\pagenumbering{gobble}

% ----------------------------------------------------------
% Section Formatting
% ----------------------------------------------------------
\titleformat{\section}{\needspace{4\baselineskip}\bfseries\large}{}{0pt}{}[\vspace{1pt}\titlerule]
\titlespacing{\section}{-1pt}{0.3 cm}{0.2 cm}

% ----------------------------------------------------------
% Custom Environments & Commands
% ----------------------------------------------------------
\renewcommand\labelitemi{$\vcenter{\hbox{\small$\bullet$}}$}

% Command for circular profile picture
\newcommand{\roundpic}[2][3cm]{
  \tikz\node [circle, minimum width = #1,
    path picture = {
      \node at (path picture bounding box.center) {
        \includegraphics[width=#1]{#2}
      };
    }] {};}

\newenvironment{highlights}{
    \begin{itemize}[topsep=0.10 cm, parsep=0.10 cm, partopsep=0pt, itemsep=0pt, leftmargin=0 cm + 10pt]
}{\end{itemize}}

\newenvironment{highlightsforbulletentries}{
    \begin{itemize}[topsep=0.10 cm, parsep=0.10 cm, partopsep=0pt, itemsep=0pt, leftmargin=10pt]
}{\end{itemize}}

\newenvironment{onecolentry}{
    \begin{adjustwidth}{0 cm + 0.00001 cm}{0 cm + 0.00001 cm}
}{\end{adjustwidth}}

\newenvironment{twocolentry}[2][]{
    \onecolentry
    \def\secondColumn{#2}
    \setcolumnwidth{\fill, 4.5 cm}
    \begin{paracol}{2}
}{
    \switchcolumn \raggedleft \secondColumn
    \end{paracol}
    \endonecolentry
}

\newenvironment{threecolentry}[3][]{
    \onecolentry
    \def\thirdColumn{#3}
    \setcolumnwidth{, \fill, 4.5 cm}
    \begin{paracol}{3}
    {\raggedright #2} \switchcolumn
}{
    \switchcolumn \raggedleft \thirdColumn
    \end{paracol}
    \endonecolentry
}

\newenvironment{header}{
    \setlength{\topsep}{0pt}\par\kern\topsep\centering\linespread{1.5}
}{\par\kern\topsep}

\let\hrefWithoutArrow\href

% Separator command for header
\newcommand{\AND}{\unskip\cleaders\copy\ANDbox\hskip\wd\ANDbox\ignorespaces}
\newsavebox\ANDbox
\sbox\ANDbox{$|$}
